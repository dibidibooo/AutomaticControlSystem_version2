{% extends 'partials/base.html' %} {% load static %} {% block extra_css %}
<!-- dragula css -->
<link href="{% static 'libs/dragula/dist/dragula.min.css' %}" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="{% static 'libs/toastr/build/toastr.min.css' %}">


<link href="{% static 'libs/select2/dist/css/select2.min.css'%}" rel="stylesheet" type="text/css" />
<link href="{% static 'libs/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css'%}" rel="stylesheet" type="text/css">
<link href="{% static 'libs/bootstrap-timepicker/css/bootstrap-timepicker.min.css'%}" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="{% static 'libs/@chenfengyuan/datepicker/dist/datepicker.min.css'%}" type="text/css" /> {% endblock %} {% block contents %}

<div class="row">
    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Запланировано</h4>
                <div id="task-2">
                    <div id="upcoming-task" class="pb-1 task-list">
                        <!-- task card -->
                        {% for task in tasks %} {% if task.status_id == 1 %}
                        <div class="card task-box" id="{{ task.id }}">
                            <div class="card-body">
                                <div class="float-end ms-2">
                                    <span class="badge rounded-pill badge-soft-secondary font-size-12" id="task-status">{{ task.status }}</span>
                                </div>
                                <div>
                                    <p class="fw-bold mb-2">
                                        <a href="" class="text-dark" id="{{ task.id }}" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="editTask(this.id)">
                                            {{ task.task.title }} для компонента '{{ task.comp_title }}'
                                        </a>
                                    </p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Место отбора проб: {{ task.sampling_site.title }}</p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Установка: {{ task.plant_unit.title }}</p>
                                    <p class="text-muted mb-2">Выполнить до: {{ task.deadline }}</p>
                                </div>
                                <div class="avatar-group float-start task-assigne">
                                    <div class="avatar-group-item">
                                        <a href="javascript: void(0);" class="d-inline-block" value="member-1">
                                            <img src="{% static 'images/users/avatar-1.jpg'%}" alt="" class="rounded-circle avatar-xs">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %} {% endfor %}
                        <!-- end task card -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end col -->
    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">В работе</h4>
                <div id="task-2">
                    <div id="inprogress-task" class="pb-1 task-list">
                        <!-- task card -->
                        {% for task in tasks %} {% if task.status_id == 2 %}
                        <div class="card task-box" id="{{ task.id }}">
                            <div class="card-body">
                                <div class="float-end ms-2">
                                    <span class="badge rounded-pill badge-soft-primary font-size-12" id="task-status">{{ task.status }}</span>
                                </div>
                                <div>
                                    <p class="fw-bold mb-2">
                                        <a href="" class="text-dark" id="{{ task.id }}" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="editTask(this.id)">
                                            {{ task.task.title }} для компонента '{{ task.comp_title }}'
                                        </a>
                                    </p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Место отбора проб: {{ task.sampling_site.title }}</p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Установка: {{ task.plant_unit.title }}</p>
                                    <p class="text-muted mb-2">Выполнить до: {{ task.deadline }}</p>
                                </div>
                                <div class="avatar-group float-start task-assigne">
                                    <div class="avatar-group-item">
                                        <a href="javascript: void(0);" class="d-inline-block" value="member-1">
                                            <img src="{% static 'images/users/avatar-1.jpg'%}" alt="" class="rounded-circle avatar-xs">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %} {% endfor %}
                        <!-- end task card -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end col -->


    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">На проверке</h4>
                <div id="task-2">
                    <div id="test-task" class="pb-1 task-list">
                        <!-- task card -->
                        {% for task in tasks %} {% if task.status_id == 3 %}
                        <div class="card task-box" id="{{ task.id }}">
                            <div class="card-body">
                                <div class="float-end ms-2">
                                    <span class="badge rounded-pill badge-soft-warning font-size-12" id="task-status">{{ task.status }}</span>
                                </div>
                                <div>
                                    <p class="fw-bold mb-2">
                                        <a href="" class="text-dark" id="{{ task.id }}" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="editTask(this.id)">
                                            {{ task.task.title }} для компонента '{{ task.comp_title }}'
                                        </a>
                                    </p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Место отбора проб: {{ task.sampling_site.title }}</p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Установка: {{ task.plant_unit.title }}</p>
                                    <p class="text-muted mb-2">Выполнить до: {{ task.deadline }}</p>
                                </div>
                                <div class="avatar-group float-start task-assigne">
                                    <div class="avatar-group-item">
                                        <a href="javascript: void(0);" class="d-inline-block" value="member-1">
                                            <img src="{% static 'images/users/avatar-1.jpg'%}" alt="" class="rounded-circle avatar-xs">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %} {% endfor %}
                        <!-- end task card -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end col -->

    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Выполнено</h4>
                <div id="task-3">
                    <div id="complete-task" class="pb-1 task-list">
                        <!-- task card -->
                        {% for task in tasks %} {% if task.status_id == 4 %}
                        <div class="card task-box" id="{{ task.id }}">
                            <div class="card-body">
                                <div class="float-end ms-2">
                                    <span class="badge rounded-pill badge-soft-success font-size-12" id="task-status">{{ task.status }}</span>
                                </div>
                                <div>
                                    <p class="fw-bold mb-2">
                                        <a href="" class="text-dark" id="{{ task.id }}" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="editTask(this.id)">
                                            {{ task.task.title }} для компонента '{{ task.comp_title }}'
                                        </a>
                                    </p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Место отбора проб: {{ task.sampling_site.title }}</p>
                                    <p class="text-muted mb-2" style="line-height: 15px;">Установка: {{ task.plant_unit.title }}</p>
                                    <p class="text-muted mb-2">Выполнить до: {{ task.deadline }}</p>
                                </div>
                                <div class="avatar-group float-start task-assigne">
                                    <div class="avatar-group-item">
                                        <a href="javascript: void(0);" class="d-inline-block" value="member-1">
                                            <img src="{% static 'images/users/avatar-1.jpg'%}" alt="" class="rounded-circle avatar-xs">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %} {% endfor %}
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- end col -->
</div>
<!-- end row -->


{#
<!--{% include 'tasks/task_update.html' %}-->#}
<div class="modal fade" id="staticBackdrop" data-bs-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <form action="" method="POST">
            <input type="hidden" name="id" id="uid"> {% csrf_token %}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel" style="max-width: 25em">
                        <b>{{ task.task.title }} для компонента {{ task.comp_title }}</b>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <h5>Task: {{ task }}</h5>

                <div class="row">
                    <div class="col-lg-7">
                        <div class="modal-body" style="margin-left: 10px">
                            <p><b>Место отбора проб:</b> {{ task.sampling_site }}</p>
                            <p><b>Установка:</b> {{ task.plant_unit }}</p>
                            <div class="row">
                                <p><b>Выполнить до: </b>{{ task.deadline }}</p>
                                <div class="col-md-6">
                                    <input class="form-control" type="datetime-local" value="{{ task.deadline }}" name="deadline" id="id_deadline">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="id_status" class="form-label"><b>Статус</b></label>
                                <select id="id_status" class="form-select" name="status">
                                    {% for status in statuses %}
                                        <option value="{{ status.pk }}" {% if status == task.status %}selected{% endif %}>{{ status }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="id_user" class="form-label"><b>Исполнитель</b></label>
                                <select id="id_user" class="form-select" name="user">
                                    {% for user in users %}
                                        <option value="{{ user.pk }}" {% if user == task.user %}selected{% endif %}>{{ user }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="#" class="form-label"><b>Наблюдатель</b></label>
                                <select id="#" class="form-select">
                                    <option selected>Выбрать..</option>
                                    <option>User 1</option>
                                    <option>User 2</option>
                                    <option>User 3</option>
                                </select>
                            </div>
                            <input type="submit" value="Изменить" name="edittask" class="btn btn-primary">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-8">
                        <div class="p-3 chat-input-section" style="margin-left: 10px">
                            <p><b>Комментарии:</b></p>
                            <div class="row">
                                <div class="col-lg-1">
                                    <div class="">
                                        <div class="avatar-xs">
                                            <div class="avatar-title rounded-circle bg-light text-primary">
                                                <i class="bx bxs-user"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="position-relative">
                                        <input type="text" class="form-control rounded chat-input" placeholder="Введите комментарий...">
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <button type="submit" class="btn btn-primary chat-send w-md waves-effect waves-light"><span class="d-none d-sm-inline-block me-2">Отправить</span>
                                        <i class="mdi mdi-send"></i></button>
                                </div>
                            </div>
                            <br>
                            <div class="col-lg-12">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item py-3">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 me-3">
                                                <div class="avatar-xs">
                                                    <div class="avatar-title rounded-circle bg-light text-primary">
                                                        <i class="bx bxs-user"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h5 class="font-size-14 mb-1">Delores Williams <small class="text-muted float-end">1 hr Ago</small></h5>
                                                <p class="text-muted">Если несколько языков объединяются, то грамматика получается индивидуальной</p>
                                            </div>
                                        </div>
                                    </li>

                                    <li class="list-group-item py-3">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 me-3">
                                                <div class="avatar-xs">
                                                    <div class="avatar-title rounded-circle bg-light text-primary">
                                                        <i class="bx bxs-user"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h5 class="font-size-14 mb-1">Keith McCoy <small class="text-muted float-end">12 Aug</small></h5>
                                                <p class="text-muted">Donec posuere vulputate arcu. phasellus accumsan cursus velit</p>
                                            </div>
                                        </div>
                                    </li>

                                    <li class="list-group-item py-3">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 me-3">
                                                <div class="avatar-xs">
                                                    <div class="avatar-title rounded-circle bg-light text-primary">
                                                        <i class="bx bxs-user"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h5 class="font-size-14 mb-1">Keith McCoy <small class="text-muted float-end">12 Aug</small></h5>
                                                <p class="text-muted">Donec posuere vulputate arcu. phasellus accumsan cursus velit</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <hr>
                        <p><b>Установка:</b> неделю назад</p>
                        <p><b>Обновлена:</b> только что</p>
                    </div>

                </div>

            </div>
        </form>
    </div>
</div>


{% endblock %} {% block extra_javascript %}
<!-- Kanban -->
<script src="{% static 'libs/dragula/dist/dragula.min.js' %}"></script>
<script src="{% static 'libs/jquery-validation/dist/jquery.validate.min.js' %}"></script>
<script src="{% static 'js/pages/task-kanban.init.js' %}"></script>
<script src="{% static 'js/pages/task-form.init.js' %}"></script>
<script src="{% static 'libs/toastr/build/toastr.min.js' %}"></script>
<script src="{% static 'js/pages/toastr.init.js' %}"></script>

<script src="{% static 'libs/select2/dist/js/select2.min.js'%}"></script>
<script src="{% static 'libs/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js'%}"></script>
<script src="{% static 'libs/bootstrap-timepicker/js/bootstrap-timepicker.min.js'%}"></script>
<script src="{% static 'libs/@chenfengyuan/datepicker/dist/datepicker.min.js'%}"></script>
<!-- form advanced init -->
<script src="{% static 'js/pages/form-advanced.init.js'%}"></script>

<script>
    function editTask(event) {
        let task_id = document.getElementById("uid");
        task_id.setAttribute("value", event);
        console.log('Event: ', event)
        $.ajax({
            url: "",
            data: {
                'taskid': event
            }
        });
    }
</script>
{% endblock %}